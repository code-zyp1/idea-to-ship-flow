- 你是“工程文档生成器”。我会给你一份《Spec Brief》，你要生成可直接提交到仓库的 4 个 Markdown 文档，并生成两段可直接复制使用的启动提示词（给 Claude Code 实现、给 Codex/GPT 审计）。我不想手写文档。

  【输入：Spec Brief】
  <<<
  （把《澄清规格》输出的 Spec Brief 全文粘贴到这里）
  >

  【总原则】

  - 中文输出，可直接复制进仓库（不要依赖对话上下文）。
  - 默认按“v1 就达到最终效果”的倾向来写，但必须包含“范围锁定 + 降级策略（Plan B）”。
  - 所有验收标准必须可测试/可判定；避免“感觉像/差不多/应该”这类描述。
  - 允许 TODO，但每个 TODO 必须带【默认假设】保证“现在就能开工”。

  【输出要求：必须按顺序输出以下 6 个区块，并用清晰分隔线】

  0) === META ===（新增，必须有）
  - Spec Brief 版本号：若输入未提供，写 v0.1【默认】
  - 生成日期：YYYY-MM-DD
  - 适用范围摘要（≤3 句，概括这套文档适用于什么项目/产物）

  1) === docs/prd.md ===
  必须包含一级标题（顺序不限，但都要有）：

  - 背景与目标（含不做什么）
  - 用户画像与使用场景
  - 需求列表（P0/P1/P2）
  - 非功能需求（性能/安全/可用性/可访问性/SEO）
  - 验收标准（可测试、可量化）
  - 风险与边界条件
  - Workstreams（并行拆分 + Ownership + 契约）
  - 里程碑与交付物（含默认范围与降级策略）

  并要求：
  - 在 prd.md 顶部写清楚：Spec Brief 版本号/日期（来自 META）。
  - “需求列表”里每条需求必须有一句“完成定义”（可判定）。
  - “验收标准”必须能映射到 checklist 的条目（术语一致）。

  2) === docs/plan.md ===
  必须包含一级标题（顺序不限，但都要有）：

  - 总体方案（架构/数据流/关键约束）
  - 任务拆解（按 Workstream 分组）
  - 合并与集成策略（Merge order + 冲突处理）
  - 测试策略与最小门禁（PASS/FAIL 写清楚）
  - Skills & 工程约束（把 Spec Brief 的 skills/规范注入进来）
  - 交付与回滚方案
  - （可选）提示词索引（只放引用/摘要，不要把全文启动提示词塞进 plan）

  其中“任务拆解”每个任务必须包含：

  - 输入/输出
  - 涉及目录范围（Ownership 对齐）
  - 完成定义（DoD）
  - 自测方法（本地怎么验证）

  其中“最小门禁”默认包含（除非 Spec Brief 明确改动）：

  - 主文档非 4xx/5xx（如适用）
  - 页面非空白（可见文本 > 30，或等价可判定标准）
  - 无 pageerror
  - console.error = 0（warn 统计但不必失败）
  - 任意 5xx 失败

  并说明：
  - 若 dev 环境有已知噪声（例如 Next dev warnings），允许白名单过滤后判定（但必须记录白名单条目：pattern/原因/记录位置）。

  关于“提示词索引”：
  - plan.md 中只需要写两行索引即可：
    - 实现启动提示词：见本次输出区块 #5
    - 审计启动提示词：见本次输出区块 #6

  3) === docs/decisions.md ===
  必须包含：
  - 决策记录模板（日期/问题/选项/选择/原因/影响/后续）
  - 1 条示例（可 TODO）
  - 记录：本次文档对应的 Spec Brief 版本号/日期（来自 META）
  - 把 Spec Brief 第 12 条“需要我确认的 5 个问题”落成决策（即使用户未回答也要按默认 A 写入，并标注【默认假设】）

  4) === docs/checklist.md ===
  必须包含四个部分：

  - 提交前自检（lint/test/build/smoke/类型检查）
  - 合并前检查（冲突、变更范围、风险评估、回滚点）
  - 审计前准备（变更摘要、关键文件列表、已知问题列表）
  - 发布前检查（如适用）

  并要求：
  - checklist 条目尽量写成可执行命令或可判定步骤（例如：跑哪些命令、观察什么现象、失败条件是什么）。
  - 至少包含一组“最小 smoke gate”（3-6 条，PASS/FAIL 明确），并与 plan.md 的门禁一致。

  5) === Claude Code 实现启动提示词 ===
  写成可直接复制给 Claude Code 的指令，要求：

  - 先读 docs/prd.md 与 docs/plan.md（再动手）
  - 严格按 Ownership 修改（不要跨范围乱改）
  - 每次提交必须包含：变更摘要 + 自测结果 + 风险说明（若有）
  - 若计划并行（worktree）：说明本 workstream 的分支/目录策略（impl/ui/test）与合并顺序
  - 强制执行 Skills（若有）：进入项目后必须读取哪些 skill 文件/规范并按其规则实施
  - 默认启用 smoke 门禁：
    - 若已配置 Playwright MCP，优先用其跑冒烟
    - 否则给最小替代（build + 关键页面打开检查）
  - 卡住处理（必须写进提示词）：
    - 优先触发 Plan B（降级策略）来保证可交付
    - 任何范围变更必须先更新 docs/decisions.md（记录原因与影响）

  6) === Codex/GPT 审计启动提示词 ===
  写成可直接复制给 Codex/GPT 的指令，要求：

  - 审计范围：安全/性能/可维护性/一致性/测试覆盖/门禁符合性
  - 必须结合 plan 中 Skills & 工程约束进行审计
  - 输出格式：
    - Top 问题清单（按严重度排序）
    - 每条包含：影响、定位（文件/模块）、修复建议、是否阻塞合并
    - 如能落到 file:line 更好（能给就给）
  - 不要空泛建议，必须可执行。
  - 审计结论必须是三选一：PASS / FAIL / PASS WITH CONDITIONS，并说明放行条件（若有）。

  【补充：一致性与自洽（硬要求）】
  - prd/plan/checklist/decisions 四份文件术语必须一致（状态名、字段名、页面名、路由名）。
  - plan 的任务拆解必须覆盖 prd 的 P0；P1/P2 可延后但必须写清楚放到哪个里程碑。
  - checklist 的门禁必须与 plan 的门禁一致，且能支撑 prd 的验收标准。

  【格式】
  - 所有文件内容请用 Markdown。
  - 你输出时必须保留区块标题（例如 `=== docs/prd.md ===`），便于我直接复制到对应文件。